<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple-todo-list</title>
</head>
<body>

    <div class="container-4">
        <div class="model"> 
            <h3>Add the name of task:</h3>
            <input id="input-task" class="task-name" type="text" placeholder=" Task Name ..  ">
            <button id="add-button">Add</button>

        </div>

        <div  id="tasks">
            <div class="task">

                <div class="task-info">
                    <ul>
                        <li>the first task</li>
                    </ul>
                </div>

                <div class="task-action">
                    <button id="delete-button" >Delete</button>
                </div>
                
            </div>

        </div>
    </div>
    
</body>

<script>

    let myTasks=[
        {
            "title" : "read book"
        }
        ,
        {
            "title" : "doing sport"
        }
    ]

    function fillTaskOnThePage(){
        document.getElementById("tasks").innerHTML = ""
        let index = 0
        for(task of myTasks){

            let content = `
                <div class="task">

                    <div class="task-info">
                        <ul>
                            <li>${task.title}</li>
                        </ul>
                    </div>

                    <div class="task-action">
                        <button onclick="deleteTask(${index})"  id="delete-button" >Delete</button>
                    </div>
                    
                </div>
            
            `
            document.getElementById("tasks").innerHTML += content
            index++;
        }

    }
    fillTaskOnThePage()


    document.getElementById("add-button").addEventListener("click",function(){
        
        let taskName = document.getElementById("input-task").value
        console.log(taskName)
        
        if (taskName.trim() === "") {
            alert("Please enter a task name!");
            return;
        }
        let taskObj = {
            "title":taskName,
        }

        myTasks.push(taskObj); 
        document.getElementById("input-task").value = "";

        // after add task stored this task in local storage
        storeTask()
        fillTaskOnThePage(); 
    })

    fillTaskOnThePage();

    //delete function
    function deleteTask(index){
        let task = myTasks[index]
        let isConfirm = confirm("Are you sure about delete this task?" + task.title)
        if(isConfirm){
            myTasks.splice(index,1)
            // after delete task stored this task in local storage
            storeTask()
            fillTaskOnThePage()
        }
    }


     //========================Local Storage========================
    try {
        function storeTask() {
            let tasksString = JSON.stringify(myTasks);
            localStorage.setItem("tasks", tasksString);
        }

        console.log("localStorage works!");

        window.onload = function() {
            storeTask();
            fillTaskOnThePage();
        };

    } catch (e) {
        console.error("localStorage error:", e);
    }




</script>
</html>